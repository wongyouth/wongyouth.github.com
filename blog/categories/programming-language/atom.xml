<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: programming language | Ryan's blog]]></title>
  <link href="http://wongyouth.com/blog/categories/programming-language/atom.xml" rel="self"/>
  <link href="http://wongyouth.com/"/>
  <updated>2014-04-09T23:11:54+08:00</updated>
  <id>http://wongyouth.com/</id>
  <author>
    <name><![CDATA[Wongyouth / 自由鱼]]></name>
    <email><![CDATA[wongyouth@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[tmall砸金蛋活动脚本]]></title>
    <link href="http://wongyouth.com/blog/2012/06/18/tmall-za-jin-dan/"/>
    <updated>2012-06-18T19:32:00+08:00</updated>
    <id>http://wongyouth.com/blog/2012/06/18/tmall-za-jin-dan</id>
    <content type="html"><![CDATA[<p>今天淘宝在砸猫猫，砸金蛋对抗京东店庆日。砸金蛋让人砸到手酸啊。<br>
于是乎写个脚本砸...</p>

<!-- more -->

<p>今天淘宝在砸猫猫，砸金蛋对抗京东店庆日。砸金蛋让人砸到手酸啊。<br>
于是就写个脚本砸，虽然机会太微妙，不过看着自动砸挺开心哈。<br>
现在活动都过去了，放出来应该不会危害什么了吧。</p>

<p>运行环境 ruby</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">gem install capybara # install capybara
ruby brick.rb
</code></pre></div>
<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span> (brick.rb)</span> <a href='/downloads/code/brick.rb'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="c1"># encoding: utf-8</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># 淘宝砸金蛋脚本</span>
</span><span class='line'><span class="c1"># 当前目录建立 tmall 文件放入帐号:密码，分号隔开</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># mailto wongyouth@gmail.com</span>
</span><span class='line'><span class="c1"># blog http://wongyouth.github.com</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;capybara&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;capybara/dsl&#39;</span>
</span><span class='line'><span class="kp">include</span> <span class="ss">Capybara</span><span class="p">:</span><span class="ss">:DSL</span>
</span><span class='line'>
</span><span class='line'><span class="no">Capybara</span><span class="o">.</span><span class="n">default_driver</span> <span class="o">=</span> <span class="ss">:selenium</span>
</span><span class='line'><span class="no">Capybara</span><span class="o">.</span><span class="n">app_host</span> <span class="o">=</span> <span class="s1">&#39;http://www.tmall.com&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">login</span>
</span><span class='line'>  <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="no">IO</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;tmall&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">visit</span><span class="p">(</span><span class="s1">&#39;http://login.tmall.com&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">setup_frame</span><span class="p">(</span><span class="s1">&#39;loginframe&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">within_frame</span><span class="p">(</span><span class="s1">&#39;loginframe&#39;</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">fill_in</span> <span class="s1">&#39;TPL_username&#39;</span><span class="p">,</span> <span class="ss">:with</span> <span class="o">=&gt;</span> <span class="n">username</span>
</span><span class='line'>    <span class="n">fill_in</span> <span class="s1">&#39;TPL_password&#39;</span><span class="p">,</span> <span class="ss">:with</span> <span class="o">=&gt;</span> <span class="n">password</span>
</span><span class='line'>    <span class="n">click_button</span> <span class="s1">&#39;登录&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">rescue</span> <span class="o">=&gt;</span> <span class="n">e</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="n">e</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">setup_frame</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</span><span class='line'>  <span class="n">jquerify</span>
</span><span class='line'>  <span class="n">page</span><span class="o">.</span><span class="n">execute_script</span> <span class="sx">%Q{</span>
</span><span class='line'><span class="sx">    jQuery(&#39;iframe&#39;).attr(&#39;name&#39;, &#39;</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="sx">&#39;);</span>
</span><span class='line'><span class="sx">  }</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">jquerify</span>
</span><span class='line'>  <span class="n">page</span><span class="o">.</span><span class="n">execute_script</span> <span class="sx">%Q{</span>
</span><span class='line'><span class="sx">    var jq = document.createElement(&#39;script&#39;);</span>
</span><span class='line'><span class="sx">    jq.src = &quot;http://code.jquery.com/jquery-latest.min.js&quot;;</span>
</span><span class='line'><span class="sx">    document.getElementsByTagName(&#39;head&#39;)[0].appendChild(jq);</span>
</span><span class='line'><span class="sx">  }</span>
</span><span class='line'>  <span class="c1"># wait to load jquery</span>
</span><span class='line'>  <span class="nb">sleep</span> <span class="mi">2</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">brick</span>
</span><span class='line'>  <span class="n">visit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="mi">10000</span><span class="o">.</span><span class="n">downto</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">find</span><span class="p">(</span><span class="s1">&#39;#J_Vol_Brick_Btn&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span>
</span><span class='line'>    <span class="nb">sleep</span> <span class="mi">1</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">rescue</span>
</span><span class='line'>  <span class="nb">sleep</span> <span class="mi">5</span>
</span><span class='line'>  <span class="k">retry</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">login</span>
</span><span class='line'><span class="n">brick</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ubuntu下安装ruby开发环境]]></title>
    <link href="http://wongyouth.com/blog/2012/04/21/install-ruby-environment-on-ubuntu/"/>
    <updated>2012-04-21T14:41:00+08:00</updated>
    <id>http://wongyouth.com/blog/2012/04/21/install-ruby-environment-on-ubuntu</id>
    <content type="html"><![CDATA[<p>要使用rails开发Web应用服务时，在Windows环境下会遇到各种各样的问题，有些Gem也会工作不正常。<br>
有些人会用MacOS作为开发环境，这当然好，但是我们在也可用免费的Ubuntu来开发，这里就介绍下安装步骤。</p>

<!-- more -->

<p>开始的时候我也是用Windows作为Rails项目开发的。<br>
但是在Windows下会碰到各种各样的问题，最常见的就是Gem包可能只工作在类Unix的环境下。<br>
有的时候按照官方说明一步一步做仍然有各种各样的不成功。痛定思痛用Ubuntu做为开发环境。</p>

<p>使用Ubuntu有个好处，每天跟Ubuntu打交道会提高整体的服务器排错水平，因为每天用的就是服务器一样的环境，遇到问题每天都要去解决，久而久之水平也就上去了。</p>

<p>闲话休提。让我们看看如何设置ruby环境吧。</p>

<ol>
<li>预安装库文件</li>
<li>安装<code>rbenv</code></li>
<li>安装<code>ruby</code></li>
<li>创建第一个<code>Rails</code>项目</li>
</ol>

<h2>预安装库文件</h2>

<h4>预安装一些编译时用到的库文件和工具</h4>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">    sudo apt-get -y install git-core curl \
    build-essential openssl libreadline6 libreadline6-dev \
    libmysqlclient-dev zlib1g zlib1g-dev libssl-dev libyaml-dev \
    libsqlite3-0 libsqlite3-dev sqlite3 \
    libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake \
    libtool bison subversion libxslt1-dev
</code></pre></div>
<p>如果使用jruby的话，安装一个jdk环境<br>
    sudo apt-get install default-jdk</p>

<h2>安装<code>rbenv</code></h2>

<p>我使用<a href="https://github.com/sstephenson/rbenv">rbenv</a>而不是rvm来作为ruby的版本管理软件。理由在rbenv的项目页面说明的很清楚了，更安全也更简单</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">    curl -L https://raw.github.com/fesplugas/rbenv-installer/master/bin/rbenv-installer | bash
</code></pre></div>
<h2>安装<code>ruby</code></h2>

<p>假设你使用ruby-1.9.3</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">    rbenv install 1.9.3-p125
    rbenv global 1.9.3-p125
</code></pre></div>
<p>常用rbenv命令</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">    rbenv versions # 查看可以安装的ruby版本列表
    rbenv version  # 查看当前的ruby版本
    rbenv rehash   # 更新rbenv里的链接指向gems的可执行文件的映射,安装了新gem包时使用

    rbenv global jruby-1.6.5         # 切换到jruby-1.6.5，下次登录系统后仍有效
    export RBENV_VERSION=jruby-1.6.5 # 切换到jruby-1.6.5环境，只适用于这一次使用
</code></pre></div>
<h2>创建第一个<code>Rails</code>项目</h2>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh">    gem update --system       # 更新gem到最新版本
    gem install bundler rails # 安装bundler和rails
    rbenv rehash              # 刷新rbenv记录的可执行文件，这样rails命令就可以直接使用了
    rails new blog
</code></pre></div>]]></content>
  </entry>
  
</feed>
